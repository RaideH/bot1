# Telegram Бот для Планирования Сообщений - Требования

## Требования для Установки

```bash
pip install python-telegram-bot pytz
```

## Инструкции по Настройке

### Шаг 1: Создание Бота в Telegram

1. **Откройте Telegram** и найдите бота @BotFather
2. **Начните диалог** с @BotFather, отправив команду `/start`
3. **Создайте нового бота**:
   - Отправьте команду `/newbot`
   - Введите имя для вашего бота (например: "Мой Планировщик Сообщений")
   - Введите username для бота (должен заканчиваться на "bot", например: "my_message_scheduler_bot")
4. **Скопируйте токен** - BotFather отправит вам токен вида `123456789:ABCdefGHIjklMNOpqrsTUVwxyz`

### Шаг 2: Подготовка Кода

1. **Скачайте файл** `telegram_scheduler_bot.py` на ваш компьютер
2. **Откройте файл** в любом текстовом редакторе
3. **Найдите строку** с `YOUR_BOT_TOKEN`:
   ```python
   application = Application.builder().token('YOUR_BOT_TOKEN').build()
   ```
4. **Замените** `YOUR_BOT_TOKEN` на ваш реальный токен:
   ```python
   application = Application.builder().token('123456789:ABCdefGHIjklMNOpqrsTUVwxyz').build()
   ```

### Шаг 3: Установка Python и Библиотек

1. **Установите Python** (если не установлен):
   - Скачайте с https://python.org
   - При установке отметьте "Add Python to PATH"

2. **Установите необходимые библиотеки**:
   ```bash
   pip install python-telegram-bot pytz
   ```

### Шаг 4: Запуск Бота

1. **Откройте командную строку** (Windows: Win+R → cmd)
2. **Перейдите в папку** с файлом бота:
   ```bash
   cd C:\путь\к\папке\с\ботом
   ```
3. **Запустите бота**:
   ```bash
   python telegram_scheduler_bot.py
   ```

### Шаг 5: Проверка Работы

1. **Найдите вашего бота** в Telegram по username
2. **Отправьте команду** `/start`
3. **Проверьте ответ** - бот должен отправить приветственное сообщение
4. **Протестируйте планирование**:
   ```
   message: Тестовое сообщение, time: 15:30
   ```

### Шаг 6: Постоянная Работа (Опционально)

Для работы бота 24/7 рассмотрите варианты:

1. **VPS/Сервер**: Арендуйте виртуальный сервер
2. **Облачные платформы**: Heroku, Railway, DigitalOcean
3. **Домашний компьютер**: Оставьте компьютер включенным

## Развертывание на Railway

### Что такое Railway?
**Railway** - современная облачная платформа для развертывания приложений. Основные преимущества:

- ✅ **Более щедрый бесплатный план** - $5 кредитов в месяц
- ✅ **Простота развертывания** - через GitHub или CLI
- ✅ **Автоматические обновления** - при пуше в репозиторий
- ✅ **Встроенная база данных** - PostgreSQL включена
- ✅ **Мониторинг** - метрики и логи в реальном времени
- ✅ **Переменные окружения** - удобное управление

### Подготовка к развертыванию на Railway

#### 1. Создайте файл requirements.txt
```
python-telegram-bot==20.7
pytz==2023.3
```

#### 2. Создайте файл railway.json (опционально)
```json
{
  "$schema": "https://railway.app/railway.schema.json",
  "build": {
    "builder": "NIXPACKS"
  },
  "deploy": {
    "startCommand": "python telegram_scheduler_bot.py",
    "healthcheckPath": "/",
    "healthcheckTimeout": 100,
    "restartPolicyType": "ON_FAILURE",
    "restartPolicyMaxRetries": 10
  }
}
```

#### 3. Модифицируйте код для Railway
Замените строку с токеном в `telegram_scheduler_bot.py`:
```python
# Вместо:
application = Application.builder().token('YOUR_BOT_TOKEN').build()

# Используйте:
import os
application = Application.builder().token(os.environ.get('BOT_TOKEN')).build()
```

### Пошаговое развертывание на Railway

#### Способ 1: Через веб-интерфейс (рекомендуется)

##### Шаг 1: Регистрация
1. Перейдите на https://railway.app
2. Нажмите "Start a New Project"
3. Войдите через GitHub (рекомендуется)

##### Шаг 2: Создание проекта
1. Нажмите "Deploy from GitHub repo"
2. Выберите ваш репозиторий с ботом
3. Railway автоматически определит Python проект

##### Шаг 3: Настройка переменных
1. Перейдите в раздел "Variables"
2. Добавьте переменную:
   - **Name**: `BOT_TOKEN`
   - **Value**: ваш токен от BotFather

##### Шаг 4: Запуск
1. Railway автоматически развернет проект
2. Бот запустится и будет работать 24/7

#### Способ 2: Через Railway CLI

##### Шаг 1: Установка CLI
```bash
npm install -g @railway/cli
```

##### Шаг 2: Вход в Railway
```bash
railway login
```

##### Шаг 3: Создание проекта
```bash
railway init
```

##### Шаг 4: Установка переменных
```bash
railway variables set BOT_TOKEN=ваш_токен_от_botfather
```

##### Шаг 5: Развертывание
```bash
railway up
```

### Управление ботом на Railway

#### Просмотр логов:
```bash
railway logs
```

#### Просмотр метрик:
- Перейдите в веб-интерфейс Railway
- Откройте раздел "Metrics"

#### Обновление кода:
```bash
git add .
git commit -m "Update bot"
git push origin main
```
Railway автоматически обновит бота.

#### Остановка/запуск:
- В веб-интерфейсе Railway
- Перейдите в настройки проекта
- Используйте кнопки "Pause" / "Resume"

### Преимущества Railway над Heroku

| Особенность | Railway | Heroku |
|-------------|---------|---------|
| **Бесплатные кредиты** | $5/месяц | 550 часов |
| **Сон приложения** | Нет | Да (30 мин) |
| **База данных** | Включена | Дополнительно |
| **Простота** | Очень просто | Просто |
| **Мониторинг** | Встроенный | Базовый |

### Ограничения Railway

⚠️ **Важно знать:**
- **$5 кредитов в месяц** бесплатно
- **Ограничения CPU** - 512 CPU units
- **Ограничения памяти** - 512MB RAM
- **Ограничения сети** - 1GB исходящего трафика

### Альтернативы Railway

1. **Render** - хорошая альтернатива с бесплатным планом
2. **DigitalOcean App Platform** - надежная платформа
3. **Fly.io** - быстрая платформа
4. **VPS** - полный контроль, но сложнее настройка

### Возможные Проблемы и Решения

**Проблема**: "ModuleNotFoundError: No module named 'telegram'"
**Решение**: Установите библиотеку: `pip install python-telegram-bot`

**Проблема**: "Invalid token"
**Решение**: Проверьте правильность токена от BotFather

**Проблема**: Бот не отвечает
**Решение**: Убедитесь, что скрипт запущен и нет ошибок в консоли

**Проблема**: "Permission denied"
**Решение**: Запустите командную строку от имени администратора

## Возможности

- Планирование сообщений для доставки в определенное время
- Поддержка как 24-часового, так и 12-часового формата времени
- Автоматическое планирование на следующий день, если время уже прошло
- Просмотр всех запланированных сообщений
- Комплексная обработка ошибок и обратная связь с пользователем
- Чистый, удобный интерфейс

## Команды Бота

- `/start` - Инициализировать бота и увидеть инструкции
- `/help` - Показать подробную справочную информацию
- `/list` - Отобразить все запланированные сообщения

## Формат Ввода

Пользователи должны предоставить ввод в формате:
```
message: Ваш текст сообщения, time: ЧЧ:ММ
```

## Поддержка Форматов Времени

- 24-часовой формат: `15:30`, `15:30:45`
- 12-часовой формат: `3:30 PM`, `3:30:45 PM`, `3:30PM`

## Обработка Ошибок

Бот предоставляет четкие сообщения об ошибках для:
- Неверного формата ввода
- Нераспознанных форматов времени
- Отсутствующих компонентов сообщения или времени
- Ошибок планирования


